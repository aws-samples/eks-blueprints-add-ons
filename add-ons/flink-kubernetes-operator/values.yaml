# for details on all options
# https://github.com/apache/flink-kubernetes-operator/blob/main/helm/flink-kubernetes-operator/values.yaml

flink-kubernetes-operator:
  webhook:
    create: true
  
  metrics:
    port: 9999

  defaultConfiguration:
    # If set to true, creates ConfigMaps/VolumeMounts. If set to false, no configuration will be created.
    # All below fields will be ignored if create is set to false.
    create: true
    # If set to true,
    #      (1) loads the built-in default configuration
    #      (2) appends the below flink-conf and logging configuration overrides
    # If set to false, loads just the overrides as in (2).
    # This option has not effect, if create is equal to false.
    append: false

    # for details of flink-conf.yaml
    # https://github.com/apache/flink-kubernetes-operator/blob/main/helm/flink-kubernetes-operator/conf/flink-conf.yaml
    flink-conf.yaml: |+
      # Flink Config Overrides
      taskmanager.numberOfTaskSlots: 1
      parallelism.default: 1

      kubernetes.operator.metrics.reporter.slf4j.factory.class: org.apache.flink.metrics.slf4j.Slf4jReporterFactory
      kubernetes.operator.metrics.reporter.slf4j.interval: 60 SECONDS
      kubernetes.operator.reconcile.interval: 15 s
      kubernetes.operator.observer.progress-check.interval: 5 s

      kubernetes.operator.metrics.reporters: prom
      kubernetes.operator.metrics.reporter.prom.class: org.apache.flink.metrics.prometheus.PrometheusReporter
      kubernetes.operator.metrics.reporter.prom.port: 9999    

      metrics.reporters: prom
      metrics.reporter.prom.class: org.apache.flink.metrics.prometheus.PrometheusReporter
      metrics.reporter.prom.port: 9999

      kubernetes.operator.health.probe.enabled: true                                                                                                                                                                                     │
      kubernetes.operator.health.probe.port: 8085   
      
    log4j-operator.properties: |+
      # Flink Operator Logging Overrides
      # This affects logging for both user code and Flink
      rootLogger.level = INFO                                                                                                                                                                                                            │
      rootLogger.appenderRef.console.ref = ConsoleAppender                                                                                                                                                                               │
      rootLogger.appenderRef.rolling.ref = RollingFileAppender                                                                                                                                                                           │
                                                                                                                                                                                                                                        │
      # Uncomment this if you want to _only_ change Flink's logging                                                                                                                                                                      │
      #logger.flink.name = org.apache.flink                                                                                                                                                                                              │
      #logger.flink.level = INFO                                                                                                                                                                                                         │
                                                                                                                                                                                                                                        │
      # The following lines keep the log level of common libraries/connectors on                                                                                                                                                         │
      # log level INFO. The root logger does not override this. You have to manually                                                                                                                                                     │
      # change the log levels here.                                                                                                                                                                                                      │
      logger.akka.name = akka                                                                                                                                                                                                            │
      logger.akka.level = INFO                                                                                                                                                                                                           │
      logger.kafka.name= org.apache.kafka                                                                                                                                                                                                │
      logger.kafka.level = INFO                                                                                                                                                                                                          │
      logger.hadoop.name = org.apache.hadoop                                                                                                                                                                                             │
      logger.hadoop.level = INFO                                                                                                                                                                                                         │
      logger.zookeeper.name = org.apache.zookeeper                                                                                                                                                                                       │
      logger.zookeeper.level = INFO                                                                                                                                                                                                      │
                                                                                                                                                                                                                                        │
      # Log all infos to the console                                                                                                                                                                                                     │
      appender.console.name = ConsoleAppender                                                                                                                                                                                            │
      appender.console.type = CONSOLE                                                                                                                                                                                                    │
      appender.console.layout.type = PatternLayout                                                                                                                                                                                       │
      appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n                                                                                                                                                 │
                                                                                                                                                                                                                                        │
      # Log all infos in the given rolling file                                                                                                                                                                                          │
      appender.rolling.name = RollingFileAppender                                                                                                                                                                                        │
      appender.rolling.type = RollingFile                                                                                                                                                                                                │
      appender.rolling.append = false                                                                                                                                                                                                    │
      appender.rolling.fileName = ${sys:log.file}                                                                                                                                                                                        │
      appender.rolling.filePattern = ${sys:log.file}.%i                                                                                                                                                                                  │
      appender.rolling.layout.type = PatternLayout                                                                                                                                                                                       │
      appender.rolling.layout.pattern = %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n                                                                                                                                                 │
      appender.rolling.policies.type = Policies                                                                                                                                                                                          │
      appender.rolling.policies.size.type = SizeBasedTriggeringPolicy                                                                                                                                                                    │
      appender.rolling.policies.size.size=100MB                                                                                                                                                                                          │
      appender.rolling.strategy.type = DefaultRolloverStrategy                                                                                                                                                                           │
      appender.rolling.strategy.max = 10                                                                                                                                                                                                 │
                                                                                                                                                                                                                                        │
      # Suppress the irrelevant (wrong) warnings from the Netty channel handler                                                                                                                                                          │
      logger.netty.name = org.apache.flink.shaded.akka.org.jboss.netty.channel.DefaultChannelPipeline                                                                                                                                    │
      logger.netty.level = OFF                                                                                                                                                                                                           │
                                                                                                                                                                                                                                        │
      # Flink Deployment Logging Overrides                                                                                                                                                                                               │
      rootLogger.appenderRef.file.ref = LogFile                                                                                                                                                                                          │
      appender.file.name = LogFile                                                                                                                                                                                                       │
      appender.file.type = File                                                                                                                                                                                                          │
      appender.file.append = false                                                                                                                                                                                                       │
      appender.file.fileName = ${sys:log.file}                                                                                                                                                                                           │
      appender.file.layout.type = PatternLayout                                                                                                                                                                                          │
      appender.file.layout.pattern = %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n
      
    log4j-console.properties: |+
      # Flink Deployment Logging Overrides
      # This affects logging for both user code and Flink
      rootLogger.level = INFO                                                                                                                                                                                                            │
      rootLogger.appenderRef.console.ref = ConsoleAppender                                                                                                                                                                               │
      rootLogger.appenderRef.rolling.ref = RollingFileAppender                                                                                                                                                                           │
                                                                                                                                                                                                                                        │
      # Uncomment this if you want to _only_ change Flink's logging                                                                                                                                                                      │
      #logger.flink.name = org.apache.flink                                                                                                                                                                                              │
      #logger.flink.level = INFO                                                                                                                                                                                                         │
                                                                                                                                                                                                                                        │
      # The following lines keep the log level of common libraries/connectors on                                                                                                                                                         │
      # log level INFO. The root logger does not override this. You have to manually                                                                                                                                                     │
      # change the log levels here.                                                                                                                                                                                                      │
      logger.akka.name = akka                                                                                                                                                                                                            │
      logger.akka.level = INFO                                                                                                                                                                                                           │
      logger.kafka.name= org.apache.kafka                                                                                                                                                                                                │
      logger.kafka.level = INFO                                                                                                                                                                                                          │
      logger.hadoop.name = org.apache.hadoop                                                                                                                                                                                             │
      logger.hadoop.level = INFO                                                                                                                                                                                                         │
      logger.zookeeper.name = org.apache.zookeeper                                                                                                                                                                                       │
      logger.zookeeper.level = INFO                                                                                                                                                                                                      │
                                                                                                                                                                                                                                        │
      # Log all infos to the console                                                                                                                                                                                                     │
      appender.console.name = ConsoleAppender                                                                                                                                                                                            │
      appender.console.type = CONSOLE                                                                                                                                                                                                    │
      appender.console.layout.type = PatternLayout                                                                                                                                                                                       │
      appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n                                                                                                                                                 │
                                                                                                                                                                                                                                        │
      # Log all infos in the given rolling file                                                                                                                                                                                          │
      appender.rolling.name = RollingFileAppender                                                                                                                                                                                        │
      appender.rolling.type = RollingFile                                                                                                                                                                                                │
      appender.rolling.append = false                                                                                                                                                                                                    │
      appender.rolling.fileName = ${sys:log.file}                                                                                                                                                                                        │
      appender.rolling.filePattern = ${sys:log.file}.%i                                                                                                                                                                                  │
      appender.rolling.layout.type = PatternLayout                                                                                                                                                                                       │
      appender.rolling.layout.pattern = %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n                                                                                                                                                 │
      appender.rolling.policies.type = Policies                                                                                                                                                                                          │
      appender.rolling.policies.size.type = SizeBasedTriggeringPolicy                                                                                                                                                                    │
      appender.rolling.policies.size.size=100MB                                                                                                                                                                                          │
      appender.rolling.strategy.type = DefaultRolloverStrategy                                                                                                                                                                           │
      appender.rolling.strategy.max = 10                                                                                                                                                                                                 │
                                                                                                                                                                                                                                        │
      # Suppress the irrelevant (wrong) warnings from the Netty channel handler                                                                                                                                                          │
      logger.netty.name = org.apache.flink.shaded.akka.org.jboss.netty.channel.DefaultChannelPipeline                                                                                                                                    │
      logger.netty.level = OFF                                                                                                                                                                                                           │
                                                                                                                                                                                                                                        │
      # Flink Deployment Logging Overrides                                                                                                                                                                                               │
      rootLogger.appenderRef.file.ref = LogFile                                                                                                                                                                                          │
      appender.file.name = LogFile                                                                                                                                                                                                       │
      appender.file.type = File                                                                                                                                                                                                          │
      appender.file.append = false                                                                                                                                                                                                       │
      appender.file.fileName = ${sys:log.file}                                                                                                                                                                                           │
      appender.file.layout.type = PatternLayout                                                                                                                                                                                          │
      appender.file.layout.pattern = %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n